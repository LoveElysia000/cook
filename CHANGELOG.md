# 智能食谱助手更新日志

## v2.1.0 - 动态翻译功能升级 (2025-10-18)

### 🚀 重大更新
**问题**：静态中英文映射表维护成本高，无法扩展到新食材/菜品
**解决**：引入AI驱动的动态翻译系统，实现无限扩展能力

### 📋 核心功能改进

#### 1. 动态翻译系统
**新增文件**：`internal/services/translation_service.go`

**三层翻译策略**：
- 高频词快速映射（鸡蛋→eggs, 西红柿→tomato等）
- AI动态翻译（DeepSeek API实时翻译）
- 降级关键词匹配（最后备选方案）

**关键特性**：
- ✅ 24小时智能缓存，避免重复翻译
- ✅ 10秒API超时控制
- ✅ 多级容错保障
- ✅ 支持任意中文食材/菜品名称

#### 2. 代码大幅精简
**移除内容**：
- `IngredientTranslation` - 60+行静态食材映射表
- `DishTranslation` - 20+行静态菜品映射表
- 复杂的条件判断逻辑

**代码量对比**：
| 项目 | 修改前 | 修改后 | 改进 |
|------|--------|--------|------|
| 映射表代码 | 100+行 | 0行 | -100% |
| 支持词汇 | 有限 | 无限制 | ∞ |
| 新增翻译 | 需手动添加 | AI自动处理 | ✅ |

#### 3. UI优化
**文件**：`static/css/style.css`
- 减少段落间空白行距离
- 优化行高和标题间距
- 提升页面信息密度和可读性

### 🔧 技术实现

#### 翻译服务架构
```
TranslationService
├── 高频词快速映射 (commonTranslations)
├── AI动态翻译 (translateWithAI + DeepSeek API)
├── 缓存系统 (24小时TTL)
├── 降级策略 (fallbackTranslation)
└── 批量翻译 (TranslateIngredients)
```

#### 翻译流程
1. **快速检查**：判断是否为英文，直接返回
2. **高频词映射**：常用词汇快速查询
3. **缓存查询**：已翻译结果缓存命中
4. **AI翻译**：调用DeepSeek API实时翻译
5. **降级处理**：关键词匹配作为最后备选



### 🔧 配置说明

#### 环境变量（无需新增）
- `DEEPSEEK_API_KEY` - AI和翻译服务共用

#### 依赖更新
- 无新增外部依赖
- 完全向后兼容

---

## v2.0.0 - 初始版本
- 基础食谱搜索功能
- AI烹饪建议
- Spoonacular API集成
- 中英文静态映射表

---

**核心价值**：从"有限词汇表"升级到"无限扩展能力"，解决了根本的可维护性问题。